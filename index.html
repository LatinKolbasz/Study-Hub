<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <link rel="icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Hub - TanulÃ¡si Platform</title>
    <link rel="stylesheet" href="index.css">

        <!-- Firebase App (modular) SDK -->
        <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
        <script>
            // Firebase konfigurÃ¡ciÃ³
            const firebaseConfig = {
                apiKey: "AIzaSyBNdafBY_6jaIDiaHJ6afm1yvFlFZsdspc",
                authDomain: "study-hub-4debf.firebaseapp.com",
                projectId: "study-hub-4debf",
                storageBucket: "study-hub-4debf.firebasestorage.app",
                messagingSenderId: "681045719671",
                appId: "1:681045719671:web:8d9c665212610578f96472",
                measurementId: "G-PGVQL7C70N"
            };
            firebase.initializeApp(firebaseConfig);
        </script>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <span class="logo-icon">ğŸ“š</span>
                    <span class="logo-text">Study Hub</span>
                </div>
                <div class="nav-user" id="navUser">
                    <!-- Theme toggle gomb -->
                    <button class="theme-toggle-btn" onclick="window.themeManager.showThemeSelector()" title="ğŸ¨ TÃ©ma">ğŸ¨</button>
                    <span id="user-info"></span>
                    <button id="login-btn" style="display:none">BejelentkezÃ©s</button>
                    <button id="logout-btn" style="display:none">KijelentkezÃ©s</button>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-content">
                <h1 class="hero-title">Study Hub</h1>
                <p class="hero-subtitle">Szervezd meg a tanulmÃ¡nyaidat Ã©s tanuld meg az Ãºj technolÃ³giÃ¡kat</p>
            </div>
            <div class="animated-background">
                <div class="floating-shape shape-1"></div>
                <div class="floating-shape shape-2"></div>
                <div class="floating-shape shape-3"></div>
            </div>
        </section>

        <section class="options-container">
            <div class="option-card assignments-card">
                <div class="card-header">
                    <span class="card-icon">âœ…</span>
                </div>
                <h2>BeadandÃ³k</h2>
                <p>Kezelj hÃ¡zit, feladatokat Ã©s hatÃ¡ridÅ‘ket egy helyen</p>
                <div class="card-features">
                    <span class="feature">ğŸ“ SzerkesztÃ©s</span>
                    <span class="feature">ğŸ“… DÃ¡tumok</span>
                    <span class="feature">â˜‘ï¸ KÃ¶vetÃ©s</span>
                </div>
                <a href="assignments.html" class="btn btn-primary">MegnyitÃ¡s</a>
            </div>

            <div class="option-card sector-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“</span>
                </div>
                <h2>Ãgazati KÃ©pzÃ©sek</h2>
                <p>Tanulj CCNA-t, Pythont, webfejlesztÃ©st Ã©s Cisco Packet Tracert</p>
                <div class="card-features">
                    <span class="feature">ğŸ“š Anyagok</span>
                    <span class="feature">ğŸ’» InteraktÃ­v</span>
                    <span class="feature">ğŸ¯ CÃ©lzott</span>
                </div>
                <a href="sector.html" class="btn btn-secondary"
                    style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">MegnyitÃ¡s</a>
            </div>

            <div class="option-card timer-card">
                <div class="card-header">
                    <span class="card-icon">â±ï¸</span>
                </div>
                <h2>Study Timer</h2>
                <p>Pomodoro technika hatÃ©kony tanulÃ¡shoz Ã©s idÅ‘beosztÃ¡shoz</p>
                <div class="card-features">
                    <span class="feature">ğŸ… Pomodoro</span>
                    <span class="feature">ğŸ“Š Statisztika</span>
                    <span class="feature">ğŸ”” Ã‰rtesÃ­tÃ©sek</span>
                </div>
                <a href="study-timer.html" class="btn btn-tertiary"
                    style="background: linear-gradient(135deg, #f59e0b, #d97706);">MegnyitÃ¡s</a>
            </div>

            <div class="option-card quiz-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“</span>
                </div>
                <h2>Quiz & Dolgozat</h2>
                <p>KÃ©szÃ­ts Ã©s oldj meg kvÃ­zeket a tanulÃ¡shoz</p>
                <div class="card-features">
                    <span class="feature">âœï¸ KÃ©szÃ­tÃ©s</span>
                    <span class="feature">âœ… MegoldÃ¡s</span>
                    <span class="feature">ğŸ“Š EredmÃ©ny</span>
                </div>
                <a href="quiz-creator.html" class="btn btn-quaternary">MegnyitÃ¡s</a>
            </div>

            <div class="option-card grades-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ†</span>
                </div>
                <h2>Jegy Tracker</h2>
                <p>KÃ¶vesd a jegyeidet videÃ³jÃ¡tÃ©k stÃ­lusban!</p>
                <div class="card-features">
                    <span class="feature">ğŸ® XP & Szint</span>
                    <span class="feature">ğŸ… Achievement</span>
                    <span class="feature">ğŸ“ˆ ElemzÃ©s</span>
                </div>
                <a href="grade-tracker.html" class="btn btn-quinary">MegnyitÃ¡s</a>
            </div>

            <div class="option-card analytics-card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“Š</span>
                </div>
                <h2>Analytics</h2>
                <p>RÃ©szletes statisztikÃ¡k Ã©s diagramok a tanulÃ¡srÃ³l</p>
                <div class="card-features">
                    <span class="feature">ğŸ“ˆ Diagramok</span>
                    <span class="feature">ğŸ”¥ Streak</span>
                    <span class="feature">ğŸ’¡ MegÃ¡llapÃ­tÃ¡sok</span>
                </div>
                <a href="analytics.html" class="btn btn-analytics">MegnyitÃ¡s</a>
            </div>
        </section>

        <section class="info-section">
            <div class="info-card">
                <h3>ğŸ’¾ Automatikus MentÃ©s</h3>
                <p>Az Ã¶sszes munkÃ¡d automatikusan mentÃ©sre kerÃ¼l</p>
            </div>
            <div class="info-card">
                <h3>âš¡ Modern Interface</h3>
                <p>Gyors, intuitÃ­v Ã©s szÃ©p felhasznÃ¡lÃ³i felÃ¼let</p>
            </div>
            <div class="info-card">
                <h3>ğŸ¨ AnimÃ¡ciÃ³k</h3>
                <p>ZÃ¶kkenÅ‘mentes Ã©s Ã©lvezetes felhasznÃ¡lÃ³i Ã©lmÃ©ny</p>
            </div>
            <div class="info-card">
                <h3>ğŸ“¦ AdatkezelÃ©s</h3>
                <p><a href="data-manager.html" style="color: #6366f1;">Export/Import adatok</a></p>
            </div>
        </section>

        <section class="qr-section" id="qr-section" style="display: none;">
            <div class="qr-container">
                <h3>ğŸ“± Telefonon elÃ©rni?</h3>
                <p>Scanneld be a kÃ³dot vagy mÃ¡sold be a linket:</p>
                <div id="qr-code"></div>
                <code id="qr-url"
                    style="display: block; margin: 1rem 0; font-size: 0.9rem;">http://studyhub.local:3000</code>
                <button onclick="document.getElementById('qr-section').style.display = 'none'"
                    style="padding: 0.5rem 1rem; background: #ec4899; color: white; border: none; border-radius: 6px; cursor: pointer;">BezÃ¡rÃ¡s</button>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-brand">ğŸ“š Study Hub</div>
            <div class="footer-links">
                <a href="index.html">FÅ‘oldal</a>
                <a href="settings.html">BeÃ¡llÃ­tÃ¡sok</a>
                <a href="data-manager.html">AdatkezelÃ©s</a>
            </div>
            <div class="footer-social">
                <a href="https://github.com/LatinKolbasz" title="GitHub">ğŸ™</a>
                <a href="mailto:pap.bence@liveedu.mathiasz.hu" title="Email">ğŸ“§</a>
            </div>
            <p class="footer-copyright">&copy; 2026 Study Hub - Minden jog fenntartva</p>
        </div>
    </footer>

    <!-- Script a footer elÅ‘tt -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="utils/auth.js"></script>
    <script src="utils/theme.js"></script>
    <script>
        // ==================== AUTH CHECK ====================
        // A tÃ©nyleges auth ellenÅ‘rzÃ©s a lap aljÃ¡n lÃ©vÅ‘ firebase.auth().onAuthStateChanged-ben tÃ¶rtÃ©nik
        // Az mindig megbÃ­zhatÃ³an fut, nincs race condition

        // BeÃ¡llÃ­tÃ¡sok betÃ¶ltÃ©se Ã©s alkalmazÃ¡sa
        function loadAndApplySettings() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');

            console.log('âš™ï¸ BeÃ¡llÃ­tÃ¡sok betÃ¶ltÃ©se:', settings);

            // TÃ©ma alkalmazÃ¡sa
            if (settings.theme || settings.primaryColor) {
                applyTheme(settings.theme || 'default', settings.primaryColor || '#6366f1');
            }

            // AnimÃ¡ciÃ³k
            if (settings.enableAnimations === false) {
                document.body.classList.add('no-animations');
            }

            // HÃ¡ttÃ©r effektek
            if (settings.enableBgEffects === false) {
                document.querySelectorAll('.floating-shape, .animated-background').forEach(el => {
                    el.style.display = 'none';
                });
            }
        }

        // TÃ©ma alkalmazÃ¡sa
        function applyTheme(theme, primaryColor) {
            console.log('ğŸ¨ TÃ©ma alkalmazÃ¡sa:', theme, primaryColor);

            // TÃ©ma hÃ¡ttÃ©r beÃ¡llÃ­tÃ¡sa
            const themes = {
                'default': 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)',
                'ocean': 'linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%)',
                'sunset': 'linear-gradient(135deg, #1e1b4b 0%, #4c1d95 100%)',
                'forest': 'linear-gradient(135deg, #052e16 0%, #14532d 100%)',
                'candy': 'linear-gradient(135deg, #831843 0%, #be185d 100%)',
                'cyberpunk': 'linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%)',
                'pastel': 'linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%)',
                'dark': '#000000'
            };

            if (themes[theme]) {
                document.body.style.background = themes[theme];
            }

            // ElsÅ‘dleges szÃ­n alkalmazÃ¡sa
            if (primaryColor) {
                document.documentElement.style.setProperty('--primary-color', primaryColor);
                // Gombok szÃ­nÃ©nek frissÃ­tÃ©se
                document.querySelectorAll('.btn-primary').forEach(btn => {
                    btn.style.background = primaryColor;
                });
            }
        }

        // FelhasznÃ¡lÃ³ prefix beÃ¡llÃ­tÃ¡sa
        function getUserPrefix() {
            if (window.authManager && window.authManager.currentUser) {
                const username = window.authManager.currentUser.username;
                let hash = 0;
                for (let i = 0; i < username.length; i++) {
                    const char = username.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return 'studyhub_' + Math.abs(hash).toString(36) + '_';
            }
            return '';
        }

        // FelhasznÃ¡lÃ³ navbar renderelÃ©s
        function renderUserNav(user) {
            const navUser = document.getElementById('navUser');
            if (!navUser) return;

            // Avatar elsÅ‘ betÅ±
            const initial = user.username.charAt(0).toUpperCase();

            // Role megjelenÃ­tÃ©s
            const roleText = user.role === 'admin' ? 'Admin' : 'FelhasznÃ¡lÃ³';

            navUser.innerHTML = `
                <div class="user-info" onclick="window.location.href='settings.html'" style="cursor: pointer;" title="BeÃ¡llÃ­tÃ¡sok">
                    <div class="user-avatar">${initial}</div>
                    <span class="user-name">${escapeHtml(user.username)}</span>
                    <span class="user-role">${roleText}</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()" title="KijelentkezÃ©s">
                    ğŸšª KijelentkezÃ©s
                </button>
            `;
        }

        // KijelentkezÃ©s kezelÃ©se
        function handleLogout() {
            if (confirm('Biztosan ki szeretnÃ©l jelentkezni?')) {
                window.authManager.logout();
            }
        }

        // XSS vÃ©delem
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '<',
                '>': '>',
                '"': '"',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // QR gomb a navbarban
        function showQR() {
            const qrSection = document.getElementById('qr-section');
            qrSection.style.display = 'block';

            // QR kÃ³d generÃ¡lÃ¡s
            const qrContainer = document.getElementById('qr-code');
            qrContainer.innerHTML = '';

            new QRCode(qrContainer, {
                text: 'http://studyhub.local:3000',
                width: 200,
                height: 200,
                colorDark: '#6366f1',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
        }
    </script>
        <script>
            // Firebase Auth UI logic
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const userInfo = document.getElementById('user-info');
      
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    userInfo.textContent = user.displayName || user.email;
                    loginBtn.style.display = 'none';
                    logoutBtn.style.display = '';

                    // Bejelentkezett felhasznÃ¡lÃ³ - nav renderelÃ©s
                    if (window.authManager) {
                        const userData = window.authManager.getUser();
                        if (userData && typeof renderUserNav === 'function') {
                            renderUserNav(userData);
                        }
                        if (window.authManager.logPageView) {
                            window.authManager.logPageView('index');
                        }
                    }
                } else {
                    // NEM vagy bejelentkezve -> AZONNAL Ã¡tirÃ¡nyÃ­tÃ¡s login.html-re
                    window.location.replace('login.html');
                    return;
                }
            });

            loginBtn.onclick = () => {
                const provider = new firebase.auth.GoogleAuthProvider();
                firebase.auth().signInWithPopup(provider);
            };
            logoutBtn.onclick = () => firebase.auth().signOut();
        </script>
</body>

</html>