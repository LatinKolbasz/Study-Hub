<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="src/favico.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Be√°ll√≠t√°sok - Study Hub</title>
    <link rel="stylesheet" href="src/index.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
        }
        .settings-container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .settings-header { text-align: center; margin-bottom: 2rem; }
        .settings-header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .settings-grid { display: grid; grid-template-columns: 280px 1fr; gap: 2rem; }
        .settings-sidebar { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 1.5rem; height: fit-content; position: sticky; top: 2rem; }
        .settings-sidebar h3 { margin-bottom: 1rem; color: #6366f1; }
        .settings-nav { list-style: none; padding: 0; margin: 0; }
        .settings-nav li { margin-bottom: 0.5rem; }
        .settings-nav button { width: 100%; padding: 0.75rem 1rem; background: transparent; border: none; color: white; text-align: left; cursor: pointer; border-radius: 8px; transition: all 0.3s; font-size: 1rem; }
        .settings-nav button:hover { background: rgba(99, 102, 241, 0.2); }
        .settings-nav button.active { background: #6366f1; }
        .settings-content { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 2rem; }
        .settings-section { display: none; }
        .settings-section.active { display: block; }
        .settings-section h2 { color: #6366f1; margin-bottom: 1.5rem; font-size: 1.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.75rem; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; background: rgba(0,0,0,0.3); color: white; font-size: 1rem; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #6366f1; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .toggle-group { display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px; margin-bottom: 0.75rem; }
        .toggle-label { display: flex; flex-direction: column; }
        .toggle-label span:first-child { font-weight: 500; }
        .toggle-label span:last-child { font-size: 0.85rem; opacity: 0.7; }
        .toggle-switch { position: relative; width: 56px; height: 28px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4b5563; transition: 0.4s; border-radius: 28px; }
        .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: 0.4s; border-radius: 50%; }
        .toggle-switch input:checked + .toggle-slider { background-color: #6366f1; }
        .toggle-switch input:checked + .toggle-slider:before { transform: translateX(28px); }
        .color-options { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .color-option { width: 40px; height: 40px; border-radius: 8px; cursor: pointer; border: 3px solid transparent; transition: all 0.3s; }
        .color-option:hover, .color-option.selected { transform: scale(1.1); border-color: white; }
        .range-group { margin-bottom: 1.5rem; }
        .range-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
        .range-value { color: #6366f1; font-weight: bold; }
        input[type="range"] { width: 100%; height: 8px; border-radius: 4px; background: rgba(255,255,255,0.2); appearance: none; }
        input[type="range"]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #6366f1; cursor: pointer; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s; }
        .btn-primary { background: #6366f1; color: white; }
        .btn-primary:hover { background: #5558e3; }
        .btn-success { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-warning { background: #f59e0b; color: white; }
        .btn-group { display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 1rem; }
        .profile-header { display: flex; align-items: center; gap: 2rem; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .profile-avatar { width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #6366f1, #8b5cf6); display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; }
        .profile-info h3 { margin: 0 0 0.5rem 0; }
        .profile-info p { margin: 0; opacity: 0.7; }
        .settings-card { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
        .settings-card h4 { margin: 0 0 1rem 0; color: #6366f1; }
        .danger-zone { border: 2px solid #ef4444; border-radius: 12px; padding: 1.5rem; margin-top: 2rem; }
        .danger-zone h3 { color: #ef4444; margin-top: 0; }
        .theme-preview { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem; }
        .theme-option { background: rgba(0,0,0,0.3); border-radius: 8px; padding: 1rem; cursor: pointer; border: 3px solid transparent; transition: all 0.3s; text-align: center; }
        .theme-option:hover, .theme-option.selected { border-color: #6366f1; transform: scale(1.02); }
        .theme-option .preview { height: 60px; border-radius: 4px; margin-bottom: 0.5rem; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .settings-section.active { animation: fadeIn 0.3s ease; }
        .back-link { display: inline-block; color: white; text-decoration: none; margin-bottom: 1rem; padding: 0.5rem 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; }
        .back-link:hover { background: rgba(255,255,255,0.2); }
        @media (max-width: 768px) { .settings-grid { grid-template-columns: 1fr; } .settings-sidebar { position: static; } }
    </style>
</head>
<body>
    <div class="settings-container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <a href="index.html" class="back-link">‚Üê Vissza a f≈ëoldalra</a>
            <button class="theme-toggle-btn" onclick="window.themeManager.showThemeSelector()" title="üé® T√©ma" style="background: rgba(255,255,255,0.15); border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">
                üé®
            </button>
        </div>
        <div class="settings-header">
            <h1>‚öôÔ∏è Be√°ll√≠t√°sok</h1>
            <p>Szabd szem√©lyre a Study Hub-ot!</p>
        </div>
        <div class="settings-grid">
            <div class="settings-sidebar">
                <h3>üìã Kateg√≥ri√°k</h3>
                <ul class="settings-nav">
                    <li><button class="active" onclick="showSection('profile', this)">üë§ Profil</button></li>
                    <li><button onclick="showSection('appearance', this)">üé® Megjelen√©s</button></li>
                    <li><button onclick="showSection('notifications', this)">üîî √ârtes√≠t√©sek</button></li>
                    <li><button onclick="showSection('privacy', this)">üîí Adatv√©delem</button></li>
                    <li><button onclick="showSection('timer', this)">‚è±Ô∏è Timer</button></li>
                    <li><button onclick="showSection('grades', this)">üèÜ Jegyek</button></li>
                    <li><button onclick="showSection('data', this)">üíæ Adatkezel√©s</button></li>
                    <li><button onclick="showSection('developer', this)">üë®‚Äçüíª Fejleszt≈ë</button></li>
                    <li><button onclick="showSection('danger', this)">‚ö†Ô∏è Vesz√©lyz√≥na</button></li>
                </ul>
            </div>
            <div class="settings-content">
                <!-- PROFIL -->
                <div id="profile" class="settings-section active">
                    <h2>üë§ Profil Be√°ll√≠t√°sok</h2>
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">L</div>
                        <div class="profile-info">
                            <h3 id="profileName">Latin Kolbasz</h3>
                            <p>Felhaszn√°l√≥</p>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üìù Szem√©lyes adatok</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Felhaszn√°l√≥n√©v</label>
                                <input type="text" id="username" value="Latin Kolbasz">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="email" value="latin@example.com">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Bio</label>
                            <textarea id="bio" rows="3" placeholder="R√≥lad..."></textarea>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üîë Jelsz√≥</h4>
                        <div class="form-group"><label>Jelenlegi jelsz√≥</label><input type="password" id="currentPassword" placeholder="********"></div>
                        <div class="form-row">
                            <div class="form-group"><label>√öj jelsz√≥</label><input type="password" id="newPassword" placeholder="********"></div>
                            <div class="form-group"><label>Jelsz√≥ √∫jra</label><input type="password" id="confirmPassword" placeholder="********"></div>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üé≠ Avatar</h4>
                        <div class="form-group">
                            <label>Avatar sz√≠n</label>
                            <div class="color-options" id="avatarColors">
                                <div class="color-option selected" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);" data-color="gradient1"></div>
                                <div class="color-option" style="background: linear-gradient(135deg, #ec4899, #f43f5e);" data-color="gradient2"></div>
                                <div class="color-option" style="background: linear-gradient(135deg, #10b981, #14b8a6);" data-color="gradient3"></div>
                                <div class="color-option" style="background: linear-gradient(135deg, #f59e0b, #ef4444);" data-color="gradient4"></div>
                                <div class="color-option" style="background: linear-gradient(135deg, #3b82f6, #06b6d4);" data-color="gradient5"></div>
                                <div class="color-option" style="background: linear-gradient(135deg, #8b5cf6, #d946ef);" data-color="gradient6"></div>
                            </div>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="saveProfile()">üíæ Ment√©s</button>
                    </div>
                </div>

                <!-- MEGJELEN√âS -->
                <div id="appearance" class="settings-section">
                    <h2>üé® Megjelen√©s</h2>
                    <div class="settings-card">
                        <h4>üåà T√©ma</h4>
                        <div class="theme-preview" id="themePreview">
                            <div class="theme-option selected" data-theme="default"><div class="preview" style="background: linear-gradient(135deg, #1a1a2e, #16213e);"></div><span>Alap√©rtelmezett</span></div>
                            <div class="theme-option" data-theme="ocean"><div class="preview" style="background: linear-gradient(135deg, #0f172a, #1e3a5f);"></div><span>√ìce√°n</span></div>
                            <div class="theme-option" data-theme="sunset"><div class="preview" style="background: linear-gradient(135deg, #1e1b4b, #4c1d95);"></div><span>Naplemente</span></div>
                            <div class="theme-option" data-theme="forest"><div class="preview" style="background: linear-gradient(135deg, #052e16, #14532d);"></div><span>Erd≈ë</span></div>
                            <div class="theme-option" data-theme="candy"><div class="preview" style="background: linear-gradient(135deg, #831843, #be185d);"></div><span>Cukorka</span></div>
                            <div class="theme-option" data-theme="cyberpunk"><div class="preview" style="background: linear-gradient(135deg, #0a0a0a, #1a1a2e);"></div><span>Cyberpunk</span></div>
                            <div class="theme-option" data-theme="pastel"><div class="preview" style="background: linear-gradient(135deg, #fce7f3, #fbcfe8);"></div><span>Pasztell</span></div>
                            <div class="theme-option" data-theme="dark"><div class="preview" style="background: #000000;"></div><span>S√∂t√©t</span></div>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üé® Sz√≠n</h4>
                        <div class="form-group">
                            <label>Els≈ëdleges sz√≠n</label>
                            <div class="color-options" id="primaryColors">
                                <div class="color-option selected" style="background: #6366f1;" data-color="#6366f1"></div>
                                <div class="color-option" style="background: #ec4899;" data-color="#ec4899"></div>
                                <div class="color-option" style="background: #10b981;" data-color="#10b981"></div>
                                <div class="color-option" style="background: #f59e0b;" data-color="#f59e0b"></div>
                                <div class="color-option" style="background: #3b82f6;" data-color="#3b82f6"></div>
                                <div class="color-option" style="background: #8b5cf6;" data-color="#8b5cf6"></div>
                                <div class="color-option" style="background: #ef4444;" data-color="#ef4444"></div>
                                <div class="color-option" style="background: #14b8a6;" data-color="#14b8a6"></div>
                            </div>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>‚ú® Effektek</h4>
                        <div class="toggle-group">
                            <div class="toggle-label"><span>Anim√°ci√≥k</span><span>Anim√°lt √°tmenetek</span></div>
                            <label class="toggle-switch"><input type="checkbox" id="enableAnimations" checked><span class="toggle-slider"></span></label>
                        </div>
                        <div class="toggle-group">
                            <div class="toggle-label"><span>H√°tt√©r effektek</span><span>Lebeg≈ë alakzatok</span></div>
                            <label class="toggle-switch"><input type="checkbox" id="enableBgEffects" checked><span class="toggle-slider"></span></label>
                        </div>
                        <div class="toggle-group">
                            <div class="toggle-label"><span>Hang effektek</span><span>Interakci√≥s hangok</span></div>
                            <label class="toggle-switch"><input type="checkbox" id="enableSound"><span class="toggle-slider"></span></label>
                        </div>
                    </div>
                    <div class="btn-group"><button class="btn btn-primary" onclick="saveAppearance()">üíæ Ment√©s</button></div>
                </div>

                <!-- √âRTES√çT√âSEK -->
                <div id="notifications" class="settings-section">
                    <h2>üîî √ârtes√≠t√©sek</h2>
                    <div class="settings-card">
                        <h4>üîî Push</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>√ñsszes</span><span>Minden √©rtes√≠t√©s</span></div><label class="toggle-switch"><input type="checkbox" id="enableNotifications" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Beadand√≥</span><span>1 nappal el≈ëtte</span></div><label class="toggle-switch"><input type="checkbox" id="notifyAssignment" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Streak</span><span>Ha kihagyt√°l napot</span></div><label class="toggle-switch"><input type="checkbox" id="notifyStreak" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Achievement</span><span>√öj achievement</span></div><label class="toggle-switch"><input type="checkbox" id="notifyAchievement" checked><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="settings-card">
                        <h4>üìß Email</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Heti √∂sszefoglal√≥</span><span>Emailben</span></div><label class="toggle-switch"><input type="checkbox" id="enableEmail"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="settings-card">
                        <h4>üîá Csendes √≥r√°k</h4>
                        <div class="form-row">
                            <div class="form-group"><label>Kezd√©s</label><input type="time" id="quietStart" value="22:00"></div>
                            <div class="form-group"><label>V√©ge</label><input type="time" id="quietEnd" value="07:00"></div>
                        </div>
                    </div>
                    <div class="btn-group"><button class="btn btn-primary" onclick="saveNotifications()">üíæ Ment√©s</button></div>
                </div>

                <!-- ADATV√âDELEM -->
                <div id="privacy" class="settings-section">
                    <h2>üîí Adatv√©delem</h2>
                    <div class="settings-card">
                        <h4>üëÅÔ∏è L√°that√≥s√°g</h4>
                        <div class="form-group">
                            <label>Ki l√°thatja?</label>
                            <select id="profileVisibility">
                                <option value="public">Mindenki</option>
                                <option value="friends">Bar√°tok</option>
                                <option value="private" selected>Csak √©n</option>
                            </select>
                        </div>
                        <div class="toggle-group"><div class="toggle-label"><span>Statisztik√°k publikus</span><span>M√°sok l√°thatj√°k</span></div><label class="toggle-switch"><input type="checkbox" id="publicStats"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Ranglista</span><span>Toplist√°n</span></div><label class="toggle-switch"><input type="checkbox" id="showOnLeaderboard"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="settings-card">
                        <h4>üç™ S√ºtik</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Analitika</span><span>Anonim statisztik√°k</span></div><label class="toggle-switch"><input type="checkbox" id="cookieAnalytics"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Marketing</span><span>Szem√©lyre szabott</span></div><label class="toggle-switch"><input type="checkbox" id="cookieMarketing"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="settings-card">
                        <h4>üìä Adatgy≈±jt√©s</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Haszn√°lati adatok</span><span>Fejleszt√©shez</span></div><label class="toggle-switch"><input type="checkbox" id="telemetryEnabled" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Hibajelent√©s</span><span>Automatikus</span></div><label class="toggle-switch"><input type="checkbox" id="errorReporting" checked><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="savePrivacy()">üíæ Ment√©s</button>
                        <button class="btn btn-warning" onclick="requestData()">üìÑ Adataim</button>
                    </div>
                </div>

                <!-- TIMER -->
                <div id="timer" class="settings-section">
                    <h2>‚è±Ô∏è Study Timer</h2>
                    <div class="settings-card">
                        <h4>‚è±Ô∏è Id≈ëbe√°ll√≠t√°sok</h4>
                        <div class="range-group">
                            <div class="range-header"><span>Tanul√°s (perc)</span><span class="range-value" id="workTimeValue">25</span></div>
                            <input type="range" id="workTime" min="5" max="90" value="25" oninput="updateRangeValue('workTime')">
                        </div>
                        <div class="range-group">
                            <div class="range-header"><span>R√∂vid sz√ºnet</span><span class="range-value" id="breakTimeValue">5</span></div>
                            <input type="range" id="breakTime" min="1" max="30" value="5" oninput="updateRangeValue('breakTime')">
                        </div>
                        <div class="range-group">
                            <div class="range-header"><span>Hossz√∫ sz√ºnet</span><span class="range-value" id="longBreakTimeValue">15</span></div>
                            <input type="range" id="longBreakTime" min="5" max="60" value="15" oninput="updateRangeValue('longBreakTime')">
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üîî Hang</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Hangok</span><span>Timer hangjelz√©se</span></div><label class="toggle-switch"><input type="checkbox" id="timerSound" checked><span class="toggle-slider"></span></label></div>
                        <div class="form-group"><label>Hang t√≠pusa</label><select id="soundType"><option value="bell">Harang</option><option value="chime">Cseng≈ë</option><option value="beep">S√≠pol√°s</option><option value="none">N√©ma</option></select></div>
                    </div>
                    <div class="settings-card">
                        <h4>üì∫ Automatika</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Auto sz√ºnet</span><span>Automatikus</span></div><label class="toggle-switch"><input type="checkbox" id="autoStartBreak"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Auto munka</span><span>Automatikus</span></div><label class="toggle-switch"><input type="checkbox" id="autoStartWork"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Desktop √©rtes√≠t√©s</span><span>Asztali</span></div><label class="toggle-switch"><input type="checkbox" id="desktopNotification" checked><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="btn-group"><button class="btn btn-primary" onclick="saveTimer()">üíæ Ment√©s</button></div>
                </div>

                <!-- JEGYEK -->
                <div id="grades" class="settings-section">
                    <h2>üèÜ Jegy Tracker</h2>
                    <div class="settings-card">
                        <h4>üìä XP be√°ll√≠t√°sok</h4>
                        <div class="range-group">
                            <div class="range-header"><span>1-es jegy XP</span><span class="range-value" id="xp1Value">10</span></div>
                            <input type="range" id="xp1" min="0" max="50" value="10" oninput="updateRangeValue('xp1')">
                        </div>
                        <div class="range-group">
                            <div class="range-header"><span>2-es jegy XP</span><span class="range-value" id="xp2Value">20</span></div>
                            <input type="range" id="xp2" min="5" max="100" value="20" oninput="updateRangeValue('xp2')">
                        </div>
                        <div class="range-group">
                            <div class="range-header"><span>5-√∂s jegy XP</span><span class="range-value" id="xp5Value">100</span></div>
                            <input type="range" id="xp5" min="50" max="200" value="100" oninput="updateRangeValue('xp5')">
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üèÖ Achievement-ek</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Achievement hangok</span><span>√öj achievementkor</span></div><label class="toggle-switch"><input type="checkbox" id="achievementSound" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Anim√°ci√≥k</span><span>Felold√°skor</span></div><label class="toggle-switch"><input type="checkbox" id="achievementAnim" checked><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="btn-group"><button class="btn btn-primary" onclick="saveGrades()">üíæ Ment√©s</button></div>
                </div>

                <!-- ADATKEZEL√âS -->
                <div id="data" class="settings-section">
                    <h2>üíæ Adatkezel√©s</h2>
                    <div class="settings-card">
                        <h4>üì• Import</h4>
                        <p>Import√°ld a kor√°bban export√°lt adataidat</p>
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; margin-bottom: 0.5rem;">üìÅ F√°jlb√≥l:</label>
                            <input type="file" id="importFileSettings" accept=".json" style="color: white;">
                            <button class="btn btn-success" onclick="importFromSettings()" style="margin-top: 0.5rem;">üìÇ Import√°l√°s</button>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h4>üì§ Export</h4>
                        <p>T√∂ltsd le az √∂sszes adatodat</p>
                        <button class="btn btn-primary" onclick="exportFromSettings()">üì• Let√∂lt√©s</button>
                    </div>
                    <div class="settings-card">
                        <h4>üóëÔ∏è T√∂rl√©s</h4>
                        <p>T√∂r√∂lj minden helyi adatot</p>
                        <button class="btn btn-danger" onclick="clearAllDataSettings()">üîÑ Adatok t√∂rl√©se</button>
                    </div>
                </div>

                <!-- FEJLESZT≈ê -->
                <div id="developer" class="settings-section">
                    <h2>üë®‚Äçüíª Fejleszt≈ë</h2>
                    <div class="settings-card">
                        <h4>üîß Fejleszt≈ëi opci√≥k</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Console logok</span><span>R√©szletes napl√≥z√°s</span></div><label class="toggle-switch"><input type="checkbox" id="devConsole"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Debug m√≥d</span><span>Fejleszt≈ëi inform√°ci√≥k</span></div><label class="toggle-switch"><input type="checkbox" id="devDebug"><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>API tesztel√©s</span><span>Teszt endpointok</span></div><label class="toggle-switch"><input type="checkbox" id="devApi"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="settings-card">
                        <h4>üìä Telemetria</h4>
                        <div class="toggle-group"><div class="toggle-label"><span>Haszn√°lati adatok k√ºld√©se</span><span>Anonim statisztik√°k</span></div><label class="toggle-switch"><input type="checkbox" id="telemetryData" checked><span class="toggle-slider"></span></label></div>
                        <div class="toggle-group"><div class="toggle-label"><span>Teljes√≠tm√©ny adatok</span><span>Sebess√©g m√©r√©s</span></div><label class="toggle-switch"><input type="checkbox" id="perfData"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="btn-group"><button class="btn btn-primary" onclick="saveDeveloper()">üíæ Ment√©s</button></div>
                </div>

                <!-- VESZ√âLYZ√ìNA -->
                <div id="danger" class="settings-section">
                    <h2>‚ö†Ô∏è Vesz√©lyz√≥na</h2>
                    <div class="danger-zone">
                        <h3>üö® V√©gleges t√∂rl√©s</h3>
                        <p>Ha t√∂r√∂l√∂d a fi√≥kodat, minden adatted v√©glegesen elveszik!</p>
                        <div class="btn-group">
                            <button class="btn btn-danger" onclick="deleteAccount()">üóëÔ∏è Fi√≥k t√∂rl√©se</button>
                        </div>
                    </div>
                    <div class="danger-zone" style="border-color: #f59e0b;">
                        <h3>üîÑ Adatok vissza√°ll√≠t√°sa</h3>
                        <p>Vissza√°ll√≠t√°s az alap√©rt√©kekre (adataid t√∂rl√©se n√©lk√ºl)</p>
                        <div class="btn-group">
                            <button class="btn btn-warning" onclick="resetSettings()">üîÑ Be√°ll√≠t√°sok vissza√°ll√≠t√°sa</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="src/utils/auth.js"></script>
    <script src="src/utils/theme.js"></script>
    <script>
        // Bejelentkez√©s ellen≈ërz√©se
        document.addEventListener('DOMContentLoaded', () => {
            // V√°runk egy kicsit, hogy az authManager inicializ√°l√≥djon
            setTimeout(() => {
                if (!window.authManager || !window.authManager.isLoggedIn()) {
                    window.location.href = 'login.html';
                    return;
                }
                console.log('‚öôÔ∏è Bejelentkezett felhaszn√°l√≥:', window.authManager.currentUser?.username);
                loadSettings();
            }, 100);
        });

        function showSection(id, btn) {
            document.querySelectorAll('.settings-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.settings-nav button').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if (btn) btn.classList.add('active');
        }

        function updateRangeValue(id) {
            const val = document.getElementById(id).value;
            document.getElementById(id + 'Value').textContent = val;
        }

        // Konzisztens prefix gener√°l√°s - ugyanaz mint grade-tracker.js √©s auth.js
        function getUserPrefix() {
            if (window.authManager && window.authManager.currentUser) {
                const username = window.authManager.currentUser.username;
                const hash = simpleHash(username);
                // Ugyanaz a form√°tum mint grade-tracker.js: studyhub_hash_gradeTracker
                return 'studyhub_' + hash + '_';
            }
            return '';
        }

        // Egyszer≈± hash f√ºggv√©ny - konzisztens az √∂sszes f√°jlban
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash).toString(36);
        }

        function loadSettings() {
            const prefix = getUserPrefix();
            console.log('üìÅ Bet√∂lt√©s prefix:', prefix);
            
            // Debug: list all keys in localStorage
            console.log('üîç LocalStorage keys:');
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.includes('studyhub')) {
                    console.log('  -', key);
                }
            }
            
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            console.log('‚öôÔ∏è Bet√∂lt√∂tt be√°ll√≠t√°sok:', settings);
            
            // Profil
            if (window.authManager && window.authManager.currentUser) {
                document.getElementById('username').value = window.authManager.currentUser.username;
                document.getElementById('email').value = window.authManager.currentUser.email || '';
                document.getElementById('profileAvatar').textContent = window.authManager.currentUser.username.charAt(0).toUpperCase();
                document.getElementById('profileName').textContent = window.authManager.currentUser.username;
                
                // Bio bet√∂lt√©se
                if (settings.bio) {
                    document.getElementById('bio').value = settings.bio;
                }
            }
            
            // T√©ma kiv√°laszt√°sa a bet√∂lt√∂tt √©rt√©k alapj√°n
            if (settings.theme) {
                document.querySelectorAll('.theme-option').forEach(opt => {
                    opt.classList.toggle('selected', opt.dataset.theme === settings.theme);
                });
            }
            
            // Sz√≠n kiv√°laszt√°sa
            if (settings.primaryColor) {
                document.querySelectorAll('#primaryColors .color-option').forEach(opt => {
                    opt.classList.toggle('selected', opt.dataset.color === settings.primaryColor);
                });
            }
            
            // Avatar sz√≠n
            if (settings.avatarColor) {
                document.querySelectorAll('#avatarColors .color-option').forEach(opt => {
                    opt.classList.toggle('selected', opt.dataset.color === settings.avatarColor);
                });
            }
            
            // Toggles - load all settings
            const toggles = ['enableAnimations','enableBgEffects','enableSound','enableNotifications','notifyAssignment','notifyStreak','notifyAchievement','enableEmail','publicStats','showOnLeaderboard','cookieAnalytics','cookieMarketing','telemetryEnabled','errorReporting','timerSound','autoStartBreak','autoStartWork','desktopNotification','achievementSound','achievementAnim','devConsole','devDebug','devApi','telemetryData','perfData'];
            toggles.forEach(id => {
                const el = document.getElementById(id);
                if (el && settings[id] !== undefined) el.checked = settings[id];
            });
            
            // Range values
            if (settings.workTime) { document.getElementById('workTime').value = settings.workTime; document.getElementById('workTimeValue').textContent = settings.workTime; }
            if (settings.breakTime) { document.getElementById('breakTime').value = settings.breakTime; document.getElementById('breakTimeValue').textContent = settings.breakTime; }
            if (settings.longBreakTime) { document.getElementById('longBreakTime').value = settings.longBreakTime; document.getElementById('longBreakTimeValue').textContent = settings.longBreakTime; }
            if (settings.xp1) { document.getElementById('xp1').value = settings.xp1; document.getElementById('xp1Value').textContent = settings.xp1; }
            if (settings.xp2) { document.getElementById('xp2').value = settings.xp2; document.getElementById('xp2Value').textContent = settings.xp2; }
            if (settings.xp5) { document.getElementById('xp5').value = settings.xp5; document.getElementById('xp5Value').textContent = settings.xp5; }
            
            // T√©ma alkalmaz√°sa a bet√∂lt√©skor
            if (settings.theme || settings.primaryColor) {
                applyTheme(settings.theme || 'default', settings.primaryColor || '#6366f1');
            }
            
            console.log('‚úÖ Be√°ll√≠t√°sok bet√∂ltve');
        }

        function saveProfile() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.bio = document.getElementById('bio').value;
            
            // Avatar sz√≠n ment√©se
            const avatarColor = document.querySelector('#avatarColors .color-option.selected')?.dataset.color;
            if (avatarColor) {
                settings.avatarColor = avatarColor;
            }
            
            // Profil adatok ment√©se az authManager-be is
            if (window.authManager && window.authManager.currentUser) {
                window.authManager.currentUser.bio = settings.bio;
                window.authManager.currentUser.avatarColor = settings.avatarColor;
            }
            
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            console.log('üíæ Profil mentve:', settings);
            alert('‚úÖ Profil mentve! Oldal friss√≠t√©se...');
            
            // Oldal √∫jrat√∂lt√©se a v√°ltoz√°sok alkalmaz√°s√°hoz
            setTimeout(() => location.reload(), 1000);
        }

        function saveAppearance() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.theme = document.querySelector('.theme-option.selected')?.dataset.theme || 'default';
            settings.primaryColor = document.querySelector('#primaryColors .color-option.selected')?.dataset.color || '#6366f1';
            settings.enableAnimations = document.getElementById('enableAnimations').checked;
            settings.enableBgEffects = document.getElementById('enableBgEffects').checked;
            settings.enableSound = document.getElementById('enableSound').checked;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            console.log('üíæ Megjelen√©s mentve:', settings);
            
            // T√©ma azonnali alkalmaz√°sa
            applyTheme(settings.theme, settings.primaryColor);
            
            alert('‚úÖ Megjelen√©s mentve √©s alkalmazva!');
        }

        // T√©ma alkalmaz√°sa
        function applyTheme(theme, primaryColor) {
            console.log('üé® T√©ma alkalmaz√°sa:', theme, primaryColor);
            
            // CSS v√°ltoz√≥k be√°ll√≠t√°sa
            const root = document.documentElement;
            
            // T√©ma h√°tt√©r be√°ll√≠t√°sa
            const themes = {
                'default': 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)',
                'ocean': 'linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%)',
                'sunset': 'linear-gradient(135deg, #1e1b4b 0%, #4c1d95 100%)',
                'forest': 'linear-gradient(135deg, #052e16 0%, #14532d 100%)',
                'candy': 'linear-gradient(135deg, #831843 0%, #be185d 100%)',
                'cyberpunk': 'linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%)',
                'pastel': 'linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%)',
                'dark': '#000000'
            };
            
            if (themes[theme]) {
                document.body.style.background = themes[theme];
            }
            
            // Els≈ëdleges sz√≠n alkalmaz√°sa
            if (primaryColor) {
                root.style.setProperty('--primary-color', primaryColor);
                // Gombok sz√≠n√©nek friss√≠t√©se
                document.querySelectorAll('.btn-primary').forEach(btn => {
                    btn.style.background = primaryColor;
                });
            }
            
            // Anim√°ci√≥k be/ki kapcsol√°sa
            if (document.getElementById('enableAnimations')) {
                const animationsEnabled = document.getElementById('enableAnimations').checked;
                document.body.style.setProperty('--animations-enabled', animationsEnabled ? '1' : '0');
            }
            
            // H√°tt√©r effektek
            if (document.getElementById('enableBgEffects')) {
                const bgEffectsEnabled = document.getElementById('enableBgEffects').checked;
                document.querySelectorAll('.floating-shape').forEach(shape => {
                    shape.style.display = bgEffectsEnabled ? 'block' : 'none';
                });
            }
        }

        function saveNotifications() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.enableNotifications = document.getElementById('enableNotifications').checked;
            settings.notifyAssignment = document.getElementById('notifyAssignment').checked;
            settings.notifyStreak = document.getElementById('notifyStreak').checked;
            settings.notifyAchievement = document.getElementById('notifyAchievement').checked;
            settings.enableEmail = document.getElementById('enableEmail').checked;
            settings.quietStart = document.getElementById('quietStart').value;
            settings.quietEnd = document.getElementById('quietEnd').value;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            console.log('üíæ √ârtes√≠t√©sek mentve:', settings);
            alert('‚úÖ √ârtes√≠t√©sek mentve!');
        }

        function savePrivacy() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.profileVisibility = document.getElementById('profileVisibility').value;
            settings.publicStats = document.getElementById('publicStats').checked;
            settings.showOnLeaderboard = document.getElementById('showOnLeaderboard').checked;
            settings.cookieAnalytics = document.getElementById('cookieAnalytics').checked;
            settings.cookieMarketing = document.getElementById('cookieMarketing').checked;
            settings.telemetryEnabled = document.getElementById('telemetryEnabled').checked;
            settings.errorReporting = document.getElementById('errorReporting').checked;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            console.log('üíæ Adatv√©delem mentve:', settings);
            alert('‚úÖ Adatv√©delem mentve!');
        }

        function saveTimer() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.workTime = parseInt(document.getElementById('workTime').value);
            settings.breakTime = parseInt(document.getElementById('breakTime').value);
            settings.longBreakTime = parseInt(document.getElementById('longBreakTime').value);
            settings.timerSound = document.getElementById('timerSound').checked;
            settings.soundType = document.getElementById('soundType').value;
            settings.autoStartBreak = document.getElementById('autoStartBreak').checked;
            settings.autoStartWork = document.getElementById('autoStartWork').checked;
            settings.desktopNotification = document.getElementById('desktopNotification').checked;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            
            // Timer be√°ll√≠t√°sok ment√©se a timerManager-nek is
            if (window.timerManager) {
                window.timerManager.settings.workTime = settings.workTime;
                window.timerManager.settings.breakTime = settings.breakTime;
                window.timerManager.settings.longBreakTime = settings.longBreakTime;
                window.timerManager.settings.soundEnabled = settings.timerSound;
                window.timerManager.saveSettings();
            }
            
            console.log('üíæ Timer be√°ll√≠t√°sok mentve:', settings);
            alert('‚úÖ Timer be√°ll√≠t√°sok mentve! A timer oldalon √©rv√©nyes√ºlnek.');
        }

        function saveGrades() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.xp1 = parseInt(document.getElementById('xp1').value);
            settings.xp2 = parseInt(document.getElementById('xp2').value);
            settings.xp5 = parseInt(document.getElementById('xp5').value);
            settings.achievementSound = document.getElementById('achievementSound').checked;
            settings.achievementAnim = document.getElementById('achievementAnim').checked;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            console.log('üíæ Jegy be√°ll√≠t√°sok mentve:', settings);
            alert('‚úÖ Jegy be√°ll√≠t√°sok mentve!');
        }

        function saveDeveloper() {
            const prefix = getUserPrefix();
            const settings = JSON.parse(localStorage.getItem(prefix + 'settings') || '{}');
            settings.devConsole = document.getElementById('devConsole').checked;
            settings.devDebug = document.getElementById('devDebug').checked;
            settings.devApi = document.getElementById('devApi').checked;
            settings.telemetryData = document.getElementById('telemetryData').checked;
            settings.perfData = document.getElementById('perfData').checked;
            localStorage.setItem(prefix + 'settings', JSON.stringify(settings));
            
            // Fejleszt≈ëi be√°ll√≠t√°sok alkalmaz√°sa
            if (settings.devConsole) {
                console.log('üîß Fejleszt≈ëi m√≥d: Console napl√≥z√°s bekapcsolva');
            }
            if (settings.devDebug) {
                console.log('üîß Fejleszt≈ëi m√≥d: Debug inform√°ci√≥k');
            }
            
            console.log('üíæ Fejleszt≈ëi be√°ll√≠t√°sok mentve:', settings);
            alert('‚úÖ Fejleszt≈ëi be√°ll√≠t√°sok mentve!');
        }

        function importFromSettings() {
            const fileInput = document.getElementById('importFileSettings');
            const file = fileInput.files[0];
            if (!file) { alert('‚ùå V√°lassz f√°jlt!'); return; }
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    const prefix = getUserPrefix();
                    if (data.gradeTracker) localStorage.setItem(prefix + 'gradeTracker', JSON.stringify(data.gradeTracker));
                    if (data.assignments) localStorage.setItem(prefix + 'assignments', JSON.stringify(data.assignments));
                    if (data.quizzes) localStorage.setItem(prefix + 'quizzes', JSON.stringify(data.quizzes));
                    if (data.settings) localStorage.setItem(prefix + 'settings', JSON.stringify(data.settings));
                    alert('‚úÖ Import√°lva! T√∂ltsd √∫jra az oldalt.');
                } catch(err) { alert('‚ùå Hiba: ' + err.message); }
            };
            reader.readAsText(file);
        }

        function exportFromSettings() {
            const prefix = getUserPrefix();
            const data = { exportDate: new Date().toISOString(), version: '1.0' };
            const keys = ['gradeTracker', 'assignments', 'quizzes', 'timerSettings', 'timerStats', 'settings'];
            keys.forEach(key => {
                const val = localStorage.getItem(prefix + key);
                if (val) data[key] = JSON.parse(val);
            });
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'studyhub_backup_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            alert('‚úÖ Export√°lva!');
        }

        function clearAllDataSettings() {
            if (!confirm('‚ö†Ô∏è Biztosan t√∂rl√∂d az √∂sszes adatot?')) return;
            const prefix = getUserPrefix();
            const keys = ['gradeTracker', 'assignments', 'quizzes', 'timerSettings', 'timerStats', 'settings'];
            keys.forEach(key => localStorage.removeItem(prefix + key));
            alert('‚úÖ Adatok t√∂r√∂lve! T√∂ltsd √∫jra az oldalt.');
        }

        function requestData() {
            const prefix = getUserPrefix();
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith(prefix)) {
                    allData[key] = localStorage.getItem(key);
                }
            }
            const blob = new Blob([JSON.stringify(allData, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'my_data.json';
            a.click();
            alert('‚úÖ Adataid elk√ºldve!');
        }

        function deleteAccount() {
            if (!confirm('üö® V√©glegesen t√∂rl√∂d a fi√≥kodat? Ez nem vonhat√≥ vissza!')) return;
            if (!confirm('‚ö†Ô∏è Biztos? Minden adatod elv√©sz!')) return;
            const prefix = getUserPrefix();
            for (let i = localStorage.length - 1; i >= 0; i--) {
                const key = localStorage.key(i);
                if (key && key.startsWith(prefix)) localStorage.removeItem(key);
            }
            localStorage.removeItem('studyhub_token');
            localStorage.removeItem('studyhub_user');
            alert('‚úÖ Fi√≥k t√∂r√∂lve. Viszontl√°t√°sra!');
            window.location.href = 'login.html';
        }

        function resetSettings() {
            if (!confirm('üîÑ Vissza√°ll√≠tod a be√°ll√≠t√°sokat?')) return;
            const prefix = getUserPrefix();
            localStorage.removeItem(prefix + 'settings');
            alert('‚úÖ Be√°ll√≠t√°sok vissza√°ll√≠tva!');
            loadSettings();
        }

        // Theme click handlers
        document.querySelectorAll('.theme-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('.theme-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
            });
        });

        // Color click handlers - primary colors
        document.querySelectorAll('#primaryColors .color-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('#primaryColors .color-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
            });
        });

        // Color click handlers - avatar colors
        document.querySelectorAll('#avatarColors .color-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('#avatarColors .color-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
                
                // Avatar sz√≠n alkalmaz√°sa az oldalon
                const color = opt.dataset.color;
                if (window.themeManager) {
                    window.themeManager.setAvatarColor(color);
                }
            });
        });

        console.log('‚öôÔ∏è Settings bet√∂ltve');
    </script>
</body>
</html>

