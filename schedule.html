<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã“rarend - Study Hub</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="schedule.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <span class="logo-icon">ğŸ“š</span>
                    <span class="logo-text">Study Hub</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <button class="theme-toggle-btn" onclick="window.themeManager.showThemeSelector()" title="ğŸ¨ TÃ©ma" style="background: rgba(255,255,255,0.15); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 1.1rem;">
                        ğŸ¨
                    </button>
                    <a href="index.html" class="back-btn">â† Vissza</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="schedule-main">
        <section class="schedule-hero">
            <h1 class="page-title">ğŸ“… Ã“rarend</h1>
            <p class="page-subtitle">SzemÃ©lyre szabott Ã³rarend hÃ©tfÅ‘tÅ‘l pÃ©ntekig</p>
        </section>

        <div class="schedule-container">
            <!-- Toolbar -->
            <div class="schedule-toolbar">
                <div class="schedule-actions">
                    <button class="schedule-btn schedule-btn-primary" onclick="document.getElementById('templateModal').classList.add('active')">
                        ğŸ“‹ Sablon betÃ¶ltÃ©se
                    </button>
                    <button class="schedule-btn schedule-btn-secondary" onclick="scheduleManager.openImportExportModal()">
                        ğŸ“¥ Import/Export
                    </button>
                    <button class="schedule-btn schedule-btn-secondary" onclick="document.getElementById('fileInput').click()">
                        ğŸ“ JSON BetÃ¶ltÃ©s
                    </button>
                    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="scheduleManager.handleFileUpload(event)">
                </div>
                <div class="schedule-actions">
                    <button class="schedule-btn schedule-btn-danger" onclick="scheduleManager.resetAll()">
                        ğŸ”„ Reset
                    </button>
                </div>
            </div>

            <!-- Schedule Grid -->
            <div class="schedule-grid" id="scheduleGrid">
                <!-- Rendered by JavaScript -->
            </div>

            <!-- Legend -->
            <div style="margin-top: 2rem; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
                <h4 style="color: white; margin-bottom: 0.75rem;">ğŸ“– HasznÃ¡lati ÃºtmutatÃ³</h4>
                <ul style="color: rgba(255,255,255,0.7); margin: 0; padding-left: 1.5rem; line-height: 1.8;">
                    <li>Kattints egy Ã³rÃ¡ra a szerkesztÃ©shez</li>
                    <li>Add meg a tantÃ¡rgy nevÃ©t</li>
                    <li>Adj hozzÃ¡ jegyzeteket/hÃ¡szszÃ³lÃ¡sokat</li>
                    <li>MentÃ©s utÃ¡n megjelenik az Ã³rarendben</li>
                </ul>
            </div>
        </div>
    </main>

    <!-- Edit Cell Modal -->
    <div class="schedule-modal" id="scheduleModal">
        <div class="schedule-modal-content">
            <div class="schedule-modal-header">
                <h2 id="scheduleModalTitle">Ã“ra szerkesztÃ©se</h2>
                <button class="schedule-modal-close" onclick="scheduleManager.closeModal()">Ã—</button>
            </div>
            <div class="schedule-modal-body">
                <div class="schedule-form-group">
                    <label for="subjectInput">TantÃ¡rgy</label>
                    <input type="text" id="subjectInput" class="schedule-form-input" placeholder="pl: Matematika" list="subjectsList">
                    <datalist id="subjectsList"></datalist>
                </div>

                <!-- Comments Section -->
                <div class="comments-section">
                    <h3>ğŸ’¬ Jegyzetek / HozzÃ¡szÃ³lÃ¡sok</h3>
                    <div class="comments-list" id="commentsList">
                        <!-- Rendered by JavaScript -->
                    </div>
                    <div class="comment-form">
                        <input type="text" id="commentInput" placeholder="Ãšj jegyzet..." maxlength="200">
                        <button onclick="scheduleManager.addComment()">â•</button>
                    </div>
                </div>
            </div>
            <div class="schedule-modal-footer">
                <button class="schedule-btn schedule-btn-danger" onclick="scheduleManager.deleteCell()">
                    ğŸ—‘ï¸ TÃ¶rlÃ©s
                </button>
                <button class="schedule-btn schedule-btn-secondary" onclick="scheduleManager.closeModal()">
                    MÃ©gse
                </button>
                <button class="schedule-btn schedule-btn-primary" onclick="scheduleManager.saveCell()">
                    ğŸ’¾ MentÃ©s
                </button>
            </div>
        </div>
    </div>

    <!-- Import/Export Modal -->
    <div class="schedule-modal" id="importExportModal">
        <div class="schedule-modal-content">
            <div class="schedule-modal-header">
                <h2>ğŸ“¥ Import / Export</h2>
                <button class="schedule-modal-close" onclick="scheduleManager.closeImportExportModal()">Ã—</button>
            </div>
            <div class="schedule-modal-body">
                <div class="schedule-form-group">
                    <label>Export (mÃ¡solÃ¡s)</label>
                    <div class="import-export-area">
                        <textarea id="exportData" readonly placeholder="Itt jelenik meg az Ã³rarend JSON formÃ¡tumban..."></textarea>
                    </div>
                    <button class="schedule-btn schedule-btn-primary" onclick="scheduleManager.exportData()" style="margin-top: 0.5rem; width: 100%;">
                        ğŸ“‹ MÃ¡solÃ¡s
                    </button>
                </div>

                <div class="schedule-form-group" style="margin-top: 1.5rem;">
                    <label>Import (beillesztÃ©s)</label>
                    <div class="import-export-area">
                        <textarea id="importData" placeholder="Illeszd be a JSON adatokat..."></textarea>
                    </div>
                    <button class="schedule-btn schedule-btn-secondary" onclick="scheduleManager.importData()" style="margin-top: 0.5rem; width: 100%;">
                        ğŸ“¥ ImportÃ¡lÃ¡s
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Template Modal -->
    <div class="schedule-modal" id="templateModal">
        <div class="schedule-modal-content">
            <div class="schedule-modal-header">
                <h2>ğŸ“‹ Sablon betÃ¶ltÃ©se</h2>
                <button class="schedule-modal-close" onclick="document.getElementById('templateModal').classList.remove('active')">Ã—</button>
            </div>
            <div class="schedule-modal-body">
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 1rem;">VÃ¡lassz egy sablont az Ã³rarendhez:</p>
                
                <div class="schedule-form-group">
                    <button class="schedule-btn schedule-btn-secondary" onclick="scheduleManager.loadTemplate('empty')" style="width: 100%; justify-content: center; padding: 1rem;">
                        ğŸ“„ Ãœres Ã³rarend
                    </button>
                </div>
                
                <div class="schedule-form-group">
                    <button class="schedule-btn schedule-btn-primary" onclick="scheduleManager.loadTemplate('gimnazium')" style="width: 100%; justify-content: center; padding: 1rem;">
                        ğŸ“ GimnÃ¡zium
                    </button>
                </div>
                
                <div class="schedule-form-group">
                    <button class="schedule-btn schedule-btn-secondary" onclick="scheduleManager.loadTemplate('szakgimnazium')" style="width: 100%; justify-content: center; padding: 1rem; background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                        ğŸ’¼ SzakgimnÃ¡zium
                    </button>
                </div>
                
                <p style="color: rgba(255,255,255,0.5); font-size: 0.85rem; margin-top: 1rem;">
                    ğŸ’¡ A sablon betÃ¶ltÃ©se utÃ¡n szerkesztheted a tantÃ¡rgyakat!
                </p>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-brand">ğŸ“š Study Hub</div>
            <div class="footer-links">
                <a href="index.html">FÅ‘oldal</a>
                <a href="settings.html">BeÃ¡llÃ­tÃ¡sok</a>
                <a href="data-manager.html">AdatkezelÃ©s</a>
            </div>
            <div class="footer-social">
                <a href="https://github.com/LatinKolbasz" title="GitHub">ğŸ™</a>
                <a href="mailto:pap.bence@liveedu.mathiasz.hu" title="Email">ğŸ“§</a>
            </div>
            <p class="footer-copyright">&copy; 2026 Study Hub - Minden jog fenntartva</p>
        </div>
    </footer>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBNdafBY_6jaIDiaHJ6afm1yvFlFZsdspc",
            authDomain: "study-hub-4debf.firebaseapp.com",
            projectId: "study-hub-4debf",
            storageBucket: "study-hub-4debf.firebasestorage.app",
            messagingSenderId: "681045719671",
            appId: "1:681045719671:web:8d9c665212610578f96472",
            measurementId: "G-PGVQL7C70N"
        };
        firebase.initializeApp(firebaseConfig);
    </script>

    <script src="utils/auth.js"></script>
    <script src="utils/theme.js"></script>
    <script src="schedule.js"></script>

    <script>
        // BejelentkezÃ©s ellenÅ‘rzÃ©se
        document.addEventListener('DOMContentLoaded', () => {
            window.authManager.checkAuthAndRedirect('login.html');

            window.authManager.whenAuthReady(() => {
                if (!window.authManager.isLoggedIn()) return;

                const user = window.authManager.getUser();
                if (user) {
                    console.log('âœ… Bejelentkezett:', user.username);
                }
            });
        });
    </script>
</body>
</html>

